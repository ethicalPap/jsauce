info:
  name: "Information Disclosure and File Vulnerability Sinks"
  author: "jsauce"
  severity: "medium"
  description: "Detect information disclosure, file operations, and privacy-related vulnerabilities"
  tags:
    - "info-disclosure"
    - "file-upload"
    - "privacy"
    - "security"

information_disclosure_sinks:
  description: "Information disclosure sinks - sensitive data exposure"
  flags: "gi"
  sensitive: true
  patterns:
    - "console\\.log\\s*\\([^)]*\\)"
    - "console\\.error\\s*\\([^)]*\\)"
    - "console\\.warn\\s*\\([^)]*\\)"
    - "console\\.info\\s*\\([^)]*\\)"
    - "console\\.debug\\s*\\([^)]*\\)"
    - "alert\\s*\\([^)]*\\)"
    - "confirm\\s*\\([^)]*\\)"
    - "prompt\\s*\\([^)]*\\)"
    - "document\\.title\\s*="

file_upload_sinks:
  description: "File upload sinks - unsafe file handling"
  flags: "gi"
  sensitive: true
  patterns:
    - "FileReader\\s*\\(\\)"
    - "readAsText\\s*\\([^)]*\\)"
    - "readAsDataURL\\s*\\([^)]*\\)"
    - "readAsBinaryString\\s*\\([^)]*\\)"
    - "readAsArrayBuffer\\s*\\([^)]*\\)"
    - "FormData\\s*\\(\\)"
    - "files\\[\\d+\\]"
    - "input\\[type=['\"`]file['\"`]\\]"

path_traversal_sinks:
  description: "Path traversal sinks - unsafe file operations"
  flags: "gi"
  sensitive: true
  patterns:
    - "fs\\.readFile\\s*\\([^)]*\\)"
    - "fs\\.writeFile\\s*\\([^)]*\\)"
    - "fs\\.createReadStream\\s*\\([^)]*\\)"
    - "fs\\.createWriteStream\\s*\\([^)]*\\)"
    - "require\\s*\\([^)]*\\)"
    - "import\\s*\\([^)]*\\)"
    - "fetch\\s*\\(['\"`]\\.\\./[^'\"``]*['\"`]"
    - "XMLHttpRequest.*\\.open\\s*\\([^,]*,\\s*['\"`]\\.\\./[^'\"``]*['\"`]"

geolocation_sinks:
  description: "Geolocation privacy sinks - location data exposure"
  flags: "gi"
  sensitive: true
  patterns:
    - "navigator\\.geolocation\\.getCurrentPosition\\s*\\([^)]*\\)"
    - "navigator\\.geolocation\\.watchPosition\\s*\\([^)]*\\)"
    - "position\\.coords\\.latitude"
    - "position\\.coords\\.longitude"
    - "coords\\.accuracy"

device_api_sinks:
  description: "Device API sinks - sensitive device information"
  flags: "gi"
  sensitive: true
  patterns:
    - "navigator\\.userAgent"
    - "navigator\\.platform"
    - "navigator\\.appVersion"
    - "navigator\\.language"
    - "navigator\\.languages"
    - "navigator\\.cookieEnabled"
    - "navigator\\.onLine"
    - "screen\\.width"
    - "screen\\.height"
    - "navigator\\.hardwareConcurrency"

xxe_sinks:
  description: "XXE (XML External Entity) sinks - unsafe XML parsing"
  flags: "gi"
  sensitive: true
  patterns:
    - "DOMParser\\s*\\(\\)\\.parseFromString\\s*\\([^)]*\\)"
    - "XMLHttpRequest.*\\.responseXML"
    - "parseXML\\s*\\([^)]*\\)"
    - "\\$\\.parseXML\\s*\\([^)]*\\)"
    - "libxmljs\\.parseXml\\s*\\([^)]*\\)"
    - "xml2js\\.parseString\\s*\\([^)]*\\)"
    - "xpath\\.select\\s*\\([^)]*\\)"